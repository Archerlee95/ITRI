

import pandas as pd
import requests as req
import json    


districts = ['士林區','大同區','大安區','中山區','中正區','內湖區','文山區','北投區','松山區','信義區','南港區','萬華區']

# api的網址需要手動抓下來，每過一段時間就需要更新網址，否則抓不到任何資訊。
urls = ['https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/9e6d693c0e30edc39b7f97995de73125?q=VTJGc2RHVmtYMThETm4vNHozMVgyNnY4NWdYNGd2M1MzMEFITGFzY0VYM1BiL3NwUVFPZGJ3am82aUZLcTE1M2xJRTJ6RVZ5TEdwSC9PSUt6UjQyS1NWL0MvUmdyVTl1SXd5QXhZUEFvZTZtMTdwenpyU2wxS3p4Q0t2SWt5ekp6T0VqTkpobzM3cDBtVjdadUVrcWdkTjRIajQyWHRNbGY2a1RQSzI0RnEyeE0yVjBNNTF2QVNkb3ZBU0k0bzBvdWt3ZHdXUGQ5ZWtRYkhWSS9JRjZ3a1NLYTlWWXI2bVFER0tmOHdUNklQaGRPN2w1OXZ2Si9yZDd6VVV2MTBQUFk4MXRwYnhUSUd0b0VySzl6c0V0eVJoYnp2K0FrS3J1RFlzYWNZS3hqY29uVUxzazhwYlNmR0ZPeDd4bHVManpBdDZURUNVS3JkaFE3dGRSQmJtZHVOdUczMnlMTzFyN3JZZmFEOUovMXM5eStqaFk0Ym1Fc0tSVE5oR1JrcjQzSGxFeTZMWGFDUU1qbjZPSXFVa0xvTzhFWFlCMEx6cjVseTZoZm5pclNoTnhSUFBwaGlYMzdxSzNVRDdSWUVZOGNoWHJZY3g3bEkyYy9kZytBZU1qZ2lGWXltZFpCTE5ZTWc3RDcyZXJyVlNQU05JZmZ5eURTWmdMaDcyVzdZdkVldXpGYzY3S2FTMEloYUN3QmRLMGZGeHJHYlBJTG0xMCtVYWMxaGlJWk5za2ZtV2FlWHI0QXltY2szSmpIcVRCVmNrMUx4VFYyblFodXhkUUoxOGxzdUw0UXBUa2RTbWk2WjlWWm5kUDB4ZXVRak9tY3BiejZqWUJwTHUrell2akJCVFdETFpyM0MyN3RabGhRZWdLVGxUUnpZSkVxMXFVWStGMG45bTlZRkxUVjlNZFhWMEMxTkRyR0lHc01sRHFMVGpub2Q2TEkzTzlqdi9UYmJpSWRBPT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/478c2f1e3dc71ebfa063c7ea5a8ba354?q=VTJGc2RHVmtYMTkzcGNyYkpmMFRnQ1ovOVU3czNGV0pMYk5GV1MzWDkwT0MyeFE4MmFsOU9yYXpuSnlyUDNocEtsbWo2NDNWWjVmSGliM25MNjQyamtkRTFudVpoUml6bXBWRGZ1bytTNHBINUZDQkx1a3R4bnJTZWpURDBCclpPdnFVNURadFBTS0s1bUR1WnNrdm04WDJ0Wlh0S2M1OU1FTUpXRWZtb1JQbjkydHpTL2dJREdMMlduT3dzeG9MSUJBcnc0MkEvUkRiMEhWNW1DZWc4SXVwdEx6dndTL3ZOY1pYY1N6a1ZTam1sS1huMlVxMU8rQ2Z0TVpoaGpyelA5L1ZMUFkrN2FaVFF6dG9BNy8ySnlLSTN6SFA1NEltUnpGQnJCUTdJdVRrb3NlOExxaUJIZjZzL0xieTBYT3grVkF2WFF5aDhkUWhmZzM4clR6cTJ1Z3UzNzlsRDIxRVM4TnBkZWc0ZGpTNGRSdzc2SHhXd2xibGtxdFduQk0xNUp3YU9wdXRkSmNQSU1WQXNkRHhpaXNYRzdqQVdSaEhFbTJrNXpPWmF0UTJRWmZ5TDhJcndPeVNQczRYRmJmY0tBemZ0djc4TWxtaERxNTY4QXd5UXlwZERrRm9rWmpwclBqUWdvY1pTc2paOGRpaXF6SUVpMDkwNTV0Z0VtaGNhYUFrZWZiY3ordlN1ZVFPMTJBbGlwYklEekZhSlhxRVZEOTBEN3lwNHRFOXk4M1VVbU01NFBuUlBFSGQ3dEtJZW8wMk82NXlJNnluM1BIRG5CVjEvMmJFV0JIeUhLLzFPUGQzangrZmtEK1hxMndBM2hUR1RPOXFObG5BRHhGVEpwQ0JER0JJeWExY0ZQMDc5WFNQYnNIY05aTUtaa3FvRlkrb1BhTnJNa2xHMWtyZEZ2ZjNNUGlWQk5aQVhhNm5jaERvWU15VlhsTWRLS0UzRGNOQUhRPT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/a7c9e146c2376224957e4c777639c3be?q=VTJGc2RHVmtYMSs4OTNyL3VpOUhSZmhWUEJxWnNKbUE3VDlhQW9nV3VGZzdTZTBWNEFFNDlEalY5ekJadGhEMUdYNVE2YVAybFV6WWdNaXBXeSszcHNkNEVHWkRidkNmUmNSaThUSXRtaDFiTnlTQ2JiYmdpbTl0MmlpQ1dYVStmaktJTk1hWmd6dGFMeFE1TDNuWEYvUFgwd3dqNUNEUmJkc2VzZnlEMy9pR3RRR1E3dHBYZzRaVitzVXE2aWFGd2ducjlhdGd0Q1RaZjZUR1VkQW1oSHZ4R25KSEt1bnVUL3FpN0FwZVVHdkZmeCswWEJhcnNoRXhQQmFic0QwSlI0M05GZVBHYUpmT1plRmRUVmxNNUJ3U3pmMjJ0QVBWRUtDYkxKK25rdWNBdERINjkzVXhkb0RJSmdtQkVSd3lCZmV2dUdHYVpOSHU3cU4zcllmT2E0VUxicXJJMk8zZDNTV3YxbFErcFN5akZaZFJrMG9vODJpZXlCaHhIRCtYaVlsR3Q1K2Q5UVhvalVJTkR3TUpsM0NYOVhQdHA5QXlyVTVxNVEzV3NramJFNlpONkNab1g2aUxIQ1A2amFyVXBEbTRzYkJFNnNscXJQM3dKZ2c4K240NGEzRzVLVmRxQlErcEs3WkRyU0RiOU1GVlJvRWw2Sk54T0ozWk9lZTdGUG1kRU04dzVvR1YxQUZaWUFnMU5HT3o4VmdaRzZOQXRDeTY3L2s2YldpamhPbzdqeERIVU5CNG96R2pHaTY1azl2QlNmZmZnWFJ3ODhyNW92UjhISXI3NWNVVjJ2UE1FUkI1dGhLUXprenArZ1dKQnByZWV5ZHQrdWZYTHBMbUdrSDZWSWR1dFVQZDJhNVVBRkE3OHhva3JBdDc5UWo1MFdIL050MW9qbi9MYXFpWUtNTlloL2hqNFVrZTYzZ25zNlpHQ2l1V2t6VTk4djFjdWFMN0hnPT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/81dcfddc09e05630e9d6ab9e92211146?q=VTJGc2RHVmtYMS9sbythZUZTR3IzdUZTZFpJSGNrNVIrcmIwdnQ0N0RjZk1SVUM2VmFIMlIzSUlEZzBFdXFGYTNuTFByUEpOTDNCNFFJcW9XeWZjQjY2WmEzU1lhUkIrNUlrSWNLbU12RW1qVmx4ZTk1SlREZXBDMzlBMUNCZjZBWUFzZXJOdDdRTFdXRlhxcjNkSFo2a2dOL2wzN0VXVEpYYStYaDBNdTRwd011L3RkOVQ0TEJNNnhhdHNFNVl6UlBsaGRoVEdBZ0JsVjhXdWEyN3RlZmxXd3BWcWdPWng1QWw0a2QxRktlcTlYaUNrVUo0aExlY1A0WFoxcDZCRU1kTDVsTlBFSFBlMlh4NHhUWnBoSUFCZm0zelVNUE1wUlRsTlBVQU5VN1pBT0o1OW4rNktrMTJKbTM3MTJWQTNXMnFtQTlZOUJGeDVSSSt1R3RvYXZSTCtzeHdSamdjVis5T3JKZ2JHMk8vT2Q0cThvWlV5MHpmeVRQOHlmcGNlclFoR2FyTitwRmtQRmUvUG5VUkhTeU1IZEprL3VTTExESUN1VnNEN3pROHhEeFRyK1MwWTZWcE9vTnZNZm5HTk9nWHBzZlVDczJSdlVjVXVUMnRUd01CYWI2TTJmNGZMQVI1WVc4eUovZ3h5RVZoc21vaE4vQ3BKV2JOaUN5b0VpYS9LSU44MllxWlg0cHAvTTJubEpsK1Jyc2JlVno4QWMwSkV1WUF2M3JxSDhkUWEvWlhWKzUycDBMaFM0TjlKS0xPcjlYVk5kYjFteVo4RlJxdEZnbzdoTGM1OTBGR09FenRRTi9idDdHQmF4UmpYcDdsQ3FTVW14MTd3Z0RrK2xGMXg5ZjRGUUZnOFNLS3lPTVZDUHc2YXF5eW80ekF0dDFCV0dEWU5VaHhXZzVPaDU5Rm0vWCtSYVJvckgzQWFCSHhGSlBBZGtVaFVueVRub1VqYzZnPT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/28aeb6ae8cf064467a8d5518b8c6558d?q=VTJGc2RHVmtYMTlEckg0R09JaGltUWpRakVQSy9OcUlPZ0RiMTRDNk1aOFNNMXg5dlhybXYreGhSYjR2cUtISFlzb3QxOXM5SFVVWWl6dE5oWDhWUVZtU0VsVmFPREc4b3VUelkybFZ5QUNaVHFNUFR6eWpNNFdPeThxWWpaeDdxU3R1T2d3czh2bUJkUTMrd28zYVhScHIzZGsyTjRleVFteXZLN2VvdXlMdXhOQ0ZFNlhLdlNPMG1NNUlvTm8wbmczT3B0alovcWNyZ1c1SmV6b1Y0ejVsVzYzR0tYVkVDWlBLQnFaYzE4SVB2cGR0WUVlYU5UM0ZiVFFCVW9zSFh4ajN4NVoxaUZDWUhDZlpsQXZRT0FwUkNDQXlQaDFad0FQZ1dBbjFaTldOOGZ4a2kvQTN2SWFMSG91NE15ZFcrS25lZ0lEcndrbnFWb1ZwbGZZR3Y1MmJKOFZXOUVQR3lpc2dhaVdxVHhGM25MYjFEZmFOcXJoM2tCYVhMTWNwTm1sQWswRFk5VnFVT1ZJd0Y0R3lTQ2NNaEZwRjdTZjZXbWVSMDBMQW84WEI0TXVJWUNzaE5KakZFV0ZldXozQ3BIRit6TVp3SmhrcUxscHhoUTJZYVVCclJuS1gxemM4S1NadjI5eUFKTjZRVkxMRWdFeGZxMlNDcjBaeWhucGFBenE4WDQrSzFRcklLcXF3RVFMbU9JN2lhME1qRzFCOUxFVmFpTXhZM3I1SEZTY0hyQS83VHZhdFh1bDhIOFUvbVR6ZTRVU3gxeFFqY3RmWUU1SGFsaktxRGR3N3F6QnhCQktEb0V0eEJienJjZ3lNQTYwaUk0cFFYOSt0OVZ4dkxMOWxHZkZwN2hFRUZreFNnZU5lY2l6d29TalRsU04yVkZpVFZ6a09SbWs3QWNyV05xUWFjM1JYNEVTbzB4dUZzU2paa1RQSFNtaHZ3aHhrb0FVSVN3PT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/544ee29649be32835d72d4a1f4478b6c?q=VTJGc2RHVmtYMTh0SDBIUkR5RVRacUd0N0paTnlXOS8zdVRjUVBndmVOZ09aWFN2QmtWZUlyakhsV2xHeUZWZ2RNM2h2eWNPV3o3dnNVOU83cjE3OTZYOVZoUnZ6czFjekVtQitod0NOL1BTNzJQVEFxcU5JUzhpWXpaTGQwQkZwQW5zR2xnRkU4VTBZRnc3V29ySjNYWVNzQlJIMkhDclUvUitidXdJU1NMSDc4K1RRVktVTDgxcytqVDdFeWEwTXlrUWRMTjZkTDRFbXd4NTVBVVg4MmR4V3l2Z1NhSHlLNmdRZjc0OFk5THB2RG1MUEFtb2Jybjl4YlRWeHp4Zk9pdkRZTnlIakc2K3gzcUNPOVNLU1M5RnhBb2hZcllwekYxM2xjdFNmcU1sVTQ3c0hqamtySzB5eHd4cGNMbzFzSENOYzlBbzU4K2ZEQmZIQXd5MXJBS3RmU1dtd0pRR0VCdE9rdEpKZWROcXlFU3B2R09kTTVkcnd3Yk56UTdLYXRvR3dSTVZIc1dhaGh0WHA4VndHdWluOHA3ZkcwSWFCZDlidk9qZ2JjRkZoVStoUzJLZ0hpamp6Zm11cEIwSERTaXJCU0UxNFhTeFZzYWJpNUx1NEQyYlI2ZXd2YzV6QWQ2WGlQMTcwdjBFYlNhYXo4eXJUSDBsbjZxT0JFOGcxZk81a1RoQXYxMmhaK01UTmhYcndEVjY3eU1VRmkyNWxrT1oxYWx2bFh0L2s0a0hYMkFDa0tkWkFudXdDQW9CdytYTUd4aXJBNDlBS2RIOE96VXZSbVU4M3NIVlJjWHUxM0xsejl2cklGdGIrVTFBZzlFUFdER2FLbmJUU3FOM3lLb1pjWlI5aFhYbkRFU09JSkVuM3RDSktVTWJuNlhBY3p6d3JFeWNhc3RRQmVmdGllVXEzVktsVHp6UVhqNXFVQTZvaHhobk5RYWo1dDdZa0JjRTh3PT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/b9236ffa82b78a00364f97a12fca7387?q=VTJGc2RHVmtYMTlDNHpFMzZPUkprbzZveU9lb2NaWDcxdWlHRUhMczVpMit6a2UyK1dQYW8vVVlxVktWZmt1ODJ4OUJpcWVMUXlldlJxT1Zvb1F1NkdqS1RYNlhvNFdRL3k1djRSR1ZDR1NtSHpnNFQrc0lzTm5OWWtBcnF2SGx1eElEUzJVN1AxL3RudnM5cHJRWllQd0Y1S3RSSERZTDlHczZrSGNRNndvd0xtTCsrNVZ0cjdsbm5ReXBJbk1zODhldDlWK0pmTnBkaXAwYlBHTnYvT3pqV05GOFBrYTJxOVhLbElMVGU4aVRUOTJFVURIcGtKUUtKd0VSWVdIcVQwSjNHM3FFSm9yNVJVMXJyL2FPYW9uTkVkVWE3YUZ2Y3F1MkcvbDNaSThTQ2EzWm5BcTd5STQ2RjIxT1BFTXdhN3RJNnZnK1VZMUlFb0VxcUx2Q1dxM205bUZ1VGUrdC9BY2YxNHpydVd2bDJkVE5ld2ZJbis0bVo3eHJQRXU1K1RiVVRHNk1oZytIMzhHYmx0Z0xucEUzS1RBKzFtcVR4UkpjVnZrNS8zNTQ0VThLNVlod1RaNEdNS2U3UG9sTGU5bHl6c3VidzE2YU55M3VvU2FzY3BUNlZVTTZEeFQ2RWtndVgxekJiUGJ2R21UZUh2NGNQWkRTWHF1RE5HZ2tDWTNHeWZibnJJZmgwYURxc0J2djZUL3FTMVUxS3dyMVhsbm80OUVBNkhwYWk3OG45eSt0aCtkK1ZqK2hhaEl0R2NaNnNPUDNJWnpZZHhXdmFnd2VyVXFJNDRLanIvYTgzbEhPSG5HS1lDMDVjNFVVakFZUlhGRzU5THY3cUE5MGR5azk2N1haV3kxV3ppazRRbmtsWUVvWjd2QTNpR3k0NnNzaXF5aWh0RUcyaXA0TTBXLyt1K0xlQ3dyUzFQRU50K2dGOGZEZHlCV1gvWWVkMmlMeUtBPT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/dfd4608ea729602b2a2c49a36d6c4597?q=VTJGc2RHVmtYMTgwWUtDNEd1NXg2YUIyUkNsZjE0bG9OZzA4WVY4QW4wNUw0VTgxTXlWaG1Dd1lQdUIxNEQ1VHU2NzJLRmtrSWltOWt4SUdRTWFhWmNqc0ZIbEJmaEthV0RpUHQwUTdXQjFITUhCVlJsK29QV2VYQkFZalllL29qNStabXNOeUUrZVRhL2VZanlCRVNUQjNIQlVFSDFBWjNJSnVYU1JicXJPZDhkVGU1dlBiY21vOG9TZFBYNmhvc28xS0pDdFVKZzI5Y0J3VmZ0Z1lPWWNOSWpvZTN6VC91S21uS0FCT2hlM2FyOHJWYTRGbXRYTmdrZEgrdVk0N0VodzNEUHdZNnZrcktjUW9lR2kvQzZnbEJjY1JpZ2xLaEl0YnFFMk1qeER3UHpPTzZnWnJSSisvYTVVbU5WQnJ2cnJDRlptQ0JGV2d2VEVCYzJiMzhpbjJqWW02STU4S0dRNERQL3FaRWJnV09zSXh2amRoMkM4UExDWGd2OEVTQlUzZnBlYW44dHdyeHJqOXNYNis5KzlkZHgrWHFua29xcGtaNVJBd2h4d1JiVUlsV09XcWEwVnhoc2JpUG1UQU1lTVhLTzUrMDRQaVJldlQxK1dueWRYaElSTXJ4MjlFdWhVMjd4dkZTb3phbTVHQ1pDWmdXcmVCOVB6RWJDblltajVONGxKOVRZalpVemFNM1l4dzJNRTlTdS9pUVBtNEo4TzM2TWFMc3g4ckdqR3dHcHdZTjNOYUxib0NDSTRhMEhnejRNMTNrS2I5eHNPSHZFVHJPYkxoTEtDdGV6bFZkaThja1pXYTdSZUhGQmplNzM4dWNpWHNscUU3bWJ4MjI4Y1NUOEsvQWdUS1pSNGU3VGFTaHBFNC9IVWVoSkk2K2xlR2VyWFRSMSs5Znp2TU13QTk4enl0YnFJZm9sVzduOHBacWJLVWE2MnBsUmQ5SUJOUUpBPT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/92a0e421e4b1886e34571f595fe551b3?q=VTJGc2RHVmtYMThFZ0NhY2wwY3FNZm8xd1JyRlhrZS8xSkRldDVjaVZvQ014S1FuWUdpV29Ib01pVVNGWjQ1ZSt3Y01zS281UmdibEoxVXZsbmZmWG11Q1ZndTVwZEhIczEyZTlRTnJoM1N3cllWSkQvVk1qckRQemE5UXlLYVA0aWF3Q0F5L1FDQjlXMHJ0V0FmVHBUT0plL1JsWDRXZFpPU0krRGRqVTh0L1o4MnNXU1A1NzlHUnFVZXBHL0NVdEdOeWpwUnFtT2tLYXdUV0VINWxUalpDeXFWaXhEemVZdyttVGozcDlaTW5IeXZETTFmVDQrdEd6NEl3Z3ErRDVYSjBlSjVRM1J4YzQ4eGxTcXdON0hkUE9LN0J4ZDVOakRVaGdlTW5tcC9tODRlZ3JJSk5QZU9yUER1S1V6bG83MlhqL1BZTENONnhYalNaZDRVMkN5aWRKZDFIa1IreDRQWTRWVnFXcXE2RTR5c0owOE0zR3ppd2krdnNUamp1ZFlWbC84dHY3WllLZHdSaittRG95RVErOEJWMlZQalE3S1cvSlZMSE43SFZCYmo0Zk0vNEhvbk5ZbThhOXppbUw0YUVUK2pmODVxZENORERVYXlFTjFMdnVUYy9vRWRKQzNLVWNhSUsydWwzeWFCbFJMUU9XaEJOTVhuUThNQzlPTkxuQWFyeHRONjY2NkdiT3hMSGI1Q3FjYitUcU5HR1hteC9WSjRUS0R2MVhNR1MyVzNjc3B4N1hrOEl3ZThrMm1rMTV3bWF0REwvamNmZkdkYlJoOXNWU09YYXF4TXdoZXdxVjFBTDFoZEUvaEkwVko4SmJTbm5zMW9jY2JtUS9BWVdNNStYc0gvekg2QXFPcFhoa2JkNDBkRThhL0x4TnVVWVZseitYdWVvR2RSRVBnb0JhRWZ1VFp1RVFwUTJxcWdpZ01JNTJyWHg3YU9GencxUnVBPT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/95b333e1d5085d07b9899b308930f40c?q=VTJGc2RHVmtYMS9sajJNNGZ3M01CTis4VUZDb20vRk1jVm5xRFlnNHFzUGlHK2p1RktBRFZmckVnSGtaSTgyUmxMc2tiN2IwNEJ6cGpNQ3doQ3lNQlZ5dWFqNTNuc0JLclpudFhvOXJjb2dIVmRrR1lRd1dFZjVwOERHTjdJL1JGb0ttV0ZRZFhlL3ZDQmxRS1JIcy9IQTU2M0ZCZW9qcTBzVmlzd0tESGZUVjdPQkxrUXh5R3IveGFIVzR0d3E4MW1jeWVHN1ArWEluTkhKZkc2THdqQjUyL1JsN2xoQzRrSWNEbHpHWkp4SFh5N3o3aFZBeExwdkN4YnBlM3ZXV0NZaUdFK2JsaE1NWmRMcjlsbVJRZUJJcHhXS3Y5dHBWa1puRHlCSmRnVEtnT0pQbHhya1J0Ri9QQmVOYXNjc2R2ODZ4MzlmdEZQK3JrWlFoZ2FWa0VicmtTbzh3UWRWai9wZ2t6WER5eVJlaGZEaWIxMDd6VnJDb3ZabmlXeWRRVmpGZ1FOdytOOHZDVGNXRDhZZWFpTGJFaDk0dWpxa0tQdzdrVFVPR2M5TUc0a3JQZTJFdlYxTng1NHVFUzc5VXU2S1pGLzZmUlhUdVdJN1FLM0tLR0huSm0vKzJON3kzeTlEcWZFTjErLzhYU3N6bUxHajhxSUsvS2Evc2JsaTNGRWh4ZkJnUTRkc2hZM2N5WTRtNjRZVmlsM3ZXOERUbDRPdWJxQ3BRaFpreDI5TGdRYmtBOHZHajlMazRDQlgwdGpPUlYwMFM1b08wM2U0Qkk5YXRBaTh4Vjd2SmhmRUlTTjJ0eHZpaUNRZElLbWZyQTFGVXpJaC9DZ1RhWmJaVVZ5WERLRkZ1Z0ltRlpUbk5Mc09wdTFhUUNZRDllak1ZM1RLdDh6WUZ2V2RabXpxYkJ2TUZNbDlGWWJjSzYrdXlrRVBhMFo5YVJuM25MTXg3b1ZUSnVBPT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/8ba24e01602deab0a8d93155b7c80c0b?q=VTJGc2RHVmtYMTlDL2NRVEV5bHdEN2RWZWJwdHNRek1td0lmc2xTejFEdnVVcFJoRlJnTnQwK3RyQy9Obitra2N1ZUZqSEpBV0h5TDJoalhnRTJrVkc4cmp4aVJEV1Npd2tmNFRaOFA0UGVoVXJrcVI4d2lpZWhpTEQrdXowYTBzRVpWckIydUhSSUU4aGJBczIxT2R6MlNXRFA3UEJUNlRzajFnOWllODJpb0xHVEdUN2hvSkgwWVI5MWJaWUJhVGZGQ1VyTk13T1QzanM4U2cyYnBUdTdzcEJWbVd4UXRuV2M2eTRYaFlSRkc2V1g3NndSckhKZXlpeDU5SzBTVWY1Z3VGYTlTNkZBOGtZam5PU0ZydWxhQXArQlBnZlduUi9PS0lNdklkSnRSV25Tay9vbXRzTDYwd0JFNUx6V20rTzJhNnZXZFRWMGpsTFdTKzVqeXF6TVcwWUdmbTFuL0pnbTJrUUZOVUxkTUNLNDdEcnc4NmxEY2xyZWhNRDJFZENMRE1MeFNBUU9HZkV4UUJuczQyUmNCM0VZd2gzMktjTWhpRDFmdFdvOWU1SytRUXdqS0FjRWNmNFByVVZ6eU1sdVlWRzU5UFExVXBoY1RhL2h2TVJLNVdtYkNOTW04eXNLRER0enhHT3FTOGdmYThLOW9YV2RZcWJBbWlqQ3JnUDJISUh6SnVScDJlRFI4M1NKYjdTZXpDY3ErWE9RTnNyeUM4U1dsUHcvc2J0QVpSb3QzL0ZMbTA0cEsyQzJGT28vcHJLOEQrckFCN0dURmxkUlo1U0psVnRtQVZUTFQ2RTRRQ3dUSG9admZhSCtwdEEwUDcxbktZQ1FJT0tPOE5uUXJhaS9pMHovZ1lCeWNkMVVEbERyc0pLUlBnRnFXODFHWFN2aVVhdXFIaCtpU0dnbkhaQXUyZkpNa2VwczdEZEFPeEMxdDVPUEQvK0gxVFR0QXV3PT0=',
        'https://lvr.land.moi.gov.tw/SERVICE/QueryPrice/4d6a55f0348d7c26b7bbccb9592c6b4e?q=VTJGc2RHVmtYMTlROHRSK2lld3BNVmtGZkRqOU5XaGZDUGx0eHM0ZW5QdUhtQjNQZDltZjFEbkx0NWpLdXdmTHFVT3RvaGFpb3BNMUQxeFMyalJaZ2liMENGbUMxaFFySDhIRlUySzB5NFNuRkRTejVDaUQxbEMwUENxMjFvOWtFeWVvbmt0Zk9UeUE5dEZQeDE2Z2NxaHRRR1A4OXhQeGowaTRIeHFOYWxQQXJxV3IwbVFIVS8rNmhVU21GbFFUVTUyR2dpTjZKVWtDT04zQml3YXdvQWdjcTdnYkNjem5Wck85cGYvbFFLNVZLZmpyZTlIbk5BNUgwWHo3Q2dLUEp3MTB1NGhvbnFYSjJXV0ZpWTdpWlJVSFAwN2lTaTRuVXFycmQzaXZmNUpCOGZ5YjF4VHRvNzMyRFdEZG83WmNaMGhmVEZsbEE5blBJUEQ0aGdnODJOMG9lQXAxWlhXRzBheVJFNVpFSHduWnNLMEYrVllYbVk3NU9WZWxnVW4vbUw1N2pnU1kwVWxhcUl0WXFhbFFZUVJ1RlFUQU82Y015cmw4K0JGMTFkSkRhaFpUaU9ETFF4MWMrSGVmRkZWUXU1TzFFcVNxQ1plRy9sTVFRTFB4WTdET3I5SlJqUWRkUlR6eEZpVnhaZWZFRi94RzN5OGJ5cVpXcGcydmxNekFuakcySFBvaWNVVWNOR2FVTVNSWmZFNWZHUXRSWU4wckYvcFpFZFh4RzYzcEx3Wkl5WVRYSEYwaE9FdlpMcC9USlhvd1pSRGJ2cGFYZ0VaMFhGcUFWenZWaXVaeHl0UW5nWXFvWU90c1VCQzY2ZWNhdXQ5Mlh5YjZGSzZvZVZPWW9ra2FkNkp3NzZJUmVobUV6djJtbGR6Vm5HKzU4UE9GVzV4dFRhUGJsNXRpNlpyTStMTjJwZkpidHUrR0JNNHl1V1VESVdKSldSeVpVdnNzVjVmTTdBPT0=']

df = pd.DataFrame()
for i in range(0,12):
    print('正再爬取 「{0}」101年12月至 112年12月的資料'.format(districts[i]))
    resp=req.get(urls[i])
    data=json.loads(resp.text)
    print('一共抓到 {0} 筆台北市{1} 至112年12月的資料'.format(len(data),districts[i]))

    house_object=[]
    for object in data :  
        one_object={}              
        one_object['經度']= object['lon']            # 經度
        one_object['緯度']= object['lat']            # 緯度     
        one_object['屋齡'] = object['g']             # 屋齡
        one_object['面積'] = object['s']             # 面積    
        one_object['建物類型'] = object['b']         # 建物型態     
        one_object['用途'] = object['pu']            # 主要用途    
        one_object['樓別/樓高'] = object['f']        # 樓別/樓高   
        one_object['佈局'] = object['v']            # 幾房幾衛幾廳
        one_object['電梯'] = object['el']           # 有無電梯       
        one_object['管理員'] = object['m']          # 有無管理員          
        one_object['車位數量'] = object['l']        # 車位數量   
        one_object['成交日期'] = object['e']        # 成交日期   
        one_object['價格'] = object['tp']           # 價格
        house_object.append(one_object)

    #--- 將原始數據保存到 CSV 檔案
    cols=['經度','緯度','屋齡','面積','建物類型','用途',
        '樓別/樓高','佈局','電梯','管理員','車位數量',
        '成交日期','價格']
    df_house = pd.DataFrame (house_object, columns = cols) # 將list 轉換為 dataframe
    df_house['行政區'] = districts[i]
    df_house['交易年份'] = df_house['成交日期'].apply(lambda x: x.split('/')[0])        
    df = pd.concat([df,df_house],axis=0)
    
df.drop(['成交日期'],axis=1,inplace=True)
df = df.reset_index(drop=True)
print('完成')


df.to_csv('台北房價new.csv',index=False)
